

test3 = ["data_result_detail_behavior_report_detail_B22170001","credit_tips_total_count", "lc_month60_m12_N_count", "lc_month60_m24_N_count", "loan_card_gm12_balance_count", "loan_card_now_amount_count", "loan_card_now_type_loan_count", "loan_card_other_consumer_count", "loan_card_r_count", "loan_card_r_guaranty_credit_no_count", "loan_card_r_ncycle_count", "loan_card_type_loan_count", "loan_second_balance_ratio_sum", "loan_second_bt_other_person_count", "loan_second_by03_balance_ratio_sum", "loan_second_by03_c5_normal_count", "loan_second_by03_is_now_sum", "loan_second_by03_ncycle_as_normal_count", "loan_second_by03_ncycle_c5_normal_count", "loan_second_by03_now_repayTerm_ratio_sum", "loan_second_by03_repayTerm_ratio_sum", "loan_second_by06_balance_ratio_sum", "loan_second_by06_ncycle_classify5_num_sum", "loan_second_by06_ncycle_is_now_sum", "loan_second_by06_ncycle_month60_State_num_size_sum", "loan_second_by06_now_planRepayAmount_sum", "loan_second_by06_now_repayTerm_ratio_sum", "loan_second_by06_repayTerm_ratio_sum", "loan_second_by12_balance_ratio_sum", "loan_second_by12_month60_to_report_mean_max", "loan_second_by12_ncycle_as_normal_count", "loan_second_by12_ncycle_month60_State_num_size_range", "loan_second_by12_ncycle_month60_to_report_mean_max", "loan_second_m12_c5_normal_count", "loan_second_m12_is_now_sum", "loan_second_m12_ncycle_planRepayAmount_mean", "loan_second_m24_month60_State_num_size_sum", "loan_second_m24_month60_to_report_max_sum", "loan_second_m24_ncycle_as_normal_count", "loan_second_m24_ncycle_month60_State_num_size_sum", "loan_second_m24_ncycle_month60_to_report_max_sum", "loan_second_m24_ncycle_RepayedAmount_ratio_sum", "loan_second_m24_ncycle_repayMons_ratio_sum", "loan_second_m24_ncycle_startDate_to_report_sum", "loan_second_month60_State_countNull_mean", "loan_second_month60_State_num_size_range", "loan_second_month60_to_report_max_sum", "loan_second_ncycle_as_normal_count", "loan_second_ncycle_c5_normal_count", "loan_second_ncycle_class_ncycle_count", "loan_second_ncycle_classify5_num_sum", "loan_second_ncycle_is_now_sum", "loan_second_ncycle_loanGrantOrg_nunique", "loan_second_ncycle_month60_State_countNull_mean", "loan_second_ncycle_month60_State_countNull_sum", "loan_second_ncycle_month60_State_num_size_range", "loan_second_ncycle_month60_to_report_max_sum", "loan_second_now_repayTerm_ratio_sum", "loan_second_repayMons_max", "loan_second_repayMons_ratio_sum", "loan_second_repayTerms_max", "loan_second_rf_month_count", "loan_second_rt_unknow_count", "loan_card_gm06_remainingTerms_count", "loan_card_now_remainingTerms_count", "loan_second_by03_ncycle_balance_ratio_sum", "loan_second_by03_ncycle_planRepayAmount_sum", "loan_second_by03_now_balance_ratio_sum", "loan_second_by06_now_balance_ratio_sum", "loan_second_by12_month60_State_num_size_range", "loan_second_by12_now_balance_ratio_sum", "loan_second_by12_now_classify5_num_sum", "loan_second_by12_now_is_now_sum", "loan_second_m06_ncycle_as_normal_count", "loan_second_m06_ncycle_c5_normal_count", "loan_second_m06_ncycle_classify5_num_sum", "loan_second_m24_RepayedAmount_ratio_sum", "loan_second_ncycle_planRepayAmount_sum", "loan_second_ncycle_repayTerm_ratio_sum", "loan_second_now_balance_ratio_sum", "loan_second_now_is_now_sum", "data_result_detail_behavior_report_detail_B22170001", "data_result_detail_behavior_report_detail_B22170052", "data_result_detail_behavior_report_detail_B22170010", "data_result_detail_behavior_report_detail_B22170006", "data_result_detail_current_report_detail_C22180009", "data_result_detail_current_report_detail_C22180007", "data_result_detail_apply_report_detail_A22160003", "data_result_detail_apply_report_detail_A22160006", "data_result_detail_behavior_report_detail_B22170043", "data_result_detail_behavior_report_detail_B22170039", "data_result_detail_behavior_report_detail_B22170009", "data_result_detail_behavior_report_detail_B22170034", "data_result_detail_current_report_detail_C22180010", "data_result_detail_current_report_detail_C22180011", "data_result_detail_behavior_report_detail_B22170050", "data_result_detail_current_report_detail_C22180001", "data_result_detail_behavior_report_detail_B22170022", "data_result_detail_behavior_report_detail_B22170025", "data_result_detail_current_report_detail_C22180012", "data_result_detail_behavior_report_detail_B22170036", "data_result_detail_behavior_report_detail_B22170019", "data_result_detail_behavior_report_detail_B22170041", "data_result_detail_behavior_report_detail_B22170035", "data_result_detail_behavior_report_detail_B22170047", "data_result_detail_behavior_report_detail_B22170027", "data_result_detail_current_report_detail_C22180006", "data_result_detail_behavior_report_detail_B22170008", "data_result_detail_behavior_report_detail_B22170007", "data_result_detail_behavior_report_detail_B22170016", "data_result_detail_behavior_report_detail_B22170013", "data_result_detail_behavior_report_detail_B22170011", "data_result_detail_behavior_report_detail_B22170042", "data_result_detail_behavior_report_detail_B22170049", "data_result_detail_behavior_report_detail_B22170023", "data_result_detail_behavior_report_detail_B22170017", "data_result_detail_current_report_detail_C22180003", "data_result_detail_behavior_report_detail_B22170044", "data_result_detail_behavior_report_detail_B22170040", "data_result_detail_behavior_report_detail_B22170045", "data_result_detail_current_report_detail_C22180005", "mobileCount", "NE_remainingAmount", "NR_D90_loanCount", "NR_D180_maxLoanAmount", "NR_D360_applyTenantCount", "NR_D360_loanCount", "NR_D360_loanAmount", "NR_D360_averageLoanAmount", "CR_validAccountCount", "CR_creditLimitSum", "CR_D360_accountCount", "CR_D360_applyTenantCount", "CR_D360_creditLimitSum", "ApplyLoanStr_fst_cell_nbank_inteday", "ApplyLoanStr_m12_cell_nbank_allnum", "ApplyLoanStr_m6_id_max_inteday", "ApplyLoanStr_m12_id_nbank_max_inteday", "ApplyLoanStr_m12_id_nbank_tot_mons", "DATA_D005", "DATA_D080", "DATA_D150", "DATA_D100", "DATA_D025", "DATA_D130"]

test1 = {"features": {
    "loan_second_balance_ratio_sum": "4.1396551244",
    "data_result_detail_current_report_detail_C22180011": "-99.0",
    "data_result_detail_current_report_detail_C22180012": "-99.0",
    "loan_second_repayMons_max": "25",
    "loan_second_by03_now_repayTerm_ratio_sum": "3.166025641",
    "DATA_D025": "0",
    "loan_second_ncycle_as_normal_count": "7",
    "loan_second_ncycle_c5_normal_count": "7",
    "data_result_detail_behavior_report_detail_B22170050": "-99.0",
    "loan_second_m12_c5_normal_count": "10",
    "data_result_detail_behavior_report_detail_B22170052": "-99.0",
    "loan_card_gm12_balance_count": "10",
    "loan_second_by12_balance_ratio_sum": "4.1396551244",
    "loan_card_now_remainingTerms_count": "11",
    "CR_D360_accountCount": "0",
    "DATA_D150": "0",
    "loan_second_by12_now_balance_ratio_sum": "4.1396551244",
    "loan_second_now_balance_ratio_sum": "4.1396551244",
    "NR_D360_averageLoanAmount": "0.0",
    "loan_second_m24_ncycle_repayMons_ratio_sum": "5.5511904762",
    "loan_second_m06_ncycle_as_normal_count": "1",
    "loan_second_m06_ncycle_c5_normal_count": "1",
    "loan_second_m24_RepayedAmount_ratio_sum": "-99.0",
    "data_result_detail_current_report_detail_C22180005": "-99.0",
    "data_result_detail_current_report_detail_C22180006": "-99.0",
    "data_result_detail_current_report_detail_C22180007": "-99.0",
    "loan_second_by06_ncycle_is_now_sum": "7",
    "data_result_detail_current_report_detail_C22180001": "-99.0",
    "data_result_detail_current_report_detail_C22180003": "-99.0",
    "loan_second_m12_is_now_sum": "10",
    "NR_D360_applyTenantCount": "5",
    "loan_second_by03_c5_normal_count": "11",
    "data_result_detail_current_report_detail_C22180009": "-99.0",
    "loan_second_bt_other_person_count": "9",
    "loan_second_ncycle_month60_State_countNull_mean": "1.625",
    "loan_second_m24_ncycle_as_normal_count": "7",
    "loan_second_by06_ncycle_month60_State_num_size_sum": "67",
    "loan_second_rf_month_count": "10",
    "loan_card_type_loan_count": "12",
    "loan_card_gm06_remainingTerms_count": "3",
    "loan_second_ncycle_planRepayAmount_sum": "4864",
    "loan_second_ncycle_repayTerm_ratio_sum": "2.2583333333",
    "data_result_detail_current_report_detail_C22180010": "-99.0",
    "NR_D90_loanCount": "0",
    "loan_card_r_guaranty_credit_no_count": "9",
    "loan_second_m24_month60_State_num_size_sum": "91",
    "loan_second_now_is_now_sum": "11",
    "loan_second_m06_ncycle_classify5_num_sum": "5.0",
    "ApplyLoanStr_fst_cell_nbank_inteday": "-99.0",
    "loan_second_by03_ncycle_planRepayAmount_sum": "4864",
    "loan_second_by03_ncycle_balance_ratio_sum": "3.0802571943",
    "ApplyLoanStr_m6_id_max_inteday": "-99.0",
    "CR_D360_applyTenantCount": "0.0",
    "data_result_detail_behavior_report_detail_B22170036": "-99.0",
    "NR_D360_loanCount": "0",
    "data_result_detail_behavior_report_detail_B22170039": "-99.0",
    "loan_second_by12_month60_to_report_mean_max": "12.0",
    "loan_second_ncycle_month60_State_num_size_range": "0.9285714286",
    "loan_card_r_count": "12",
    "data_result_detail_behavior_report_detail_B22170035": "-99.0",
    "loan_second_rt_unknow_count": "7",
    "data_result_detail_behavior_report_detail_B22170034": "-99.0",
    "loan_second_ncycle_is_now_sum": "7",
    "loan_second_by06_repayTerm_ratio_sum": "3.166025641",
    "loan_second_m24_ncycle_RepayedAmount_ratio_sum": "-99.0",
    "loan_second_repayMons_ratio_sum": "9.6834981685",
    "data_result_detail_behavior_report_detail_B22170040": "-99.0",
    "loan_second_m24_ncycle_month60_State_num_size_sum": "68",
    "data_result_detail_behavior_report_detail_B22170042": "-99.0",
    "data_result_detail_behavior_report_detail_B22170041": "-99.0",
    "ApplyLoanStr_m12_id_nbank_tot_mons": "-99.0",
    "loan_second_by03_is_now_sum": "11",
    "loan_second_m12_ncycle_planRepayAmount_mean": "669.1428571429",
    "data_result_detail_behavior_report_detail_B22170047": "-99.0",
    "data_result_detail_behavior_report_detail_B22170049": "-99.0",
    "data_result_detail_behavior_report_detail_B22170044": "-99.0",
    "data_result_detail_behavior_report_detail_B22170043": "-99.0",
    "loan_second_ncycle_loanGrantOrg_nunique": "5",
    "data_result_detail_behavior_report_detail_B22170045": "-99.0",
    "data_result_detail_behavior_report_detail_B22170008": "-99.0",
    "CR_D360_creditLimitSum": "0.0",
    "data_result_detail_behavior_report_detail_B22170007": "-99.0",
    "loan_second_by12_ncycle_month60_to_report_mean_max": "12.0",
    "data_result_detail_behavior_report_detail_B22170009": "-99.0",
    "CR_validAccountCount": "0",
    "DATA_D100": "0",
    "loan_second_by06_balance_ratio_sum": "4.1396551244",
    "loan_second_ncycle_class_ncycle_count": "8",
    "loan_second_m24_ncycle_startDate_to_report_sum": "75",
    "lc_month60_m12_N_count": "72",
    "loan_second_by06_now_repayTerm_ratio_sum": "3.166025641",
    "loan_second_month60_State_num_size_range": "0.9285714286",
    "data_result_detail_behavior_report_detail_B22170017": "-99.0",
    "loan_second_now_repayTerm_ratio_sum": "3.166025641",
    "data_result_detail_behavior_report_detail_B22170016": "-99.0",
    "data_result_detail_behavior_report_detail_B22170011": "-99.0",
    "data_result_detail_behavior_report_detail_B22170010": "-99.0",
    "data_result_detail_behavior_report_detail_B22170013": "-99.0",
    "loan_second_by03_repayTerm_ratio_sum": "3.166025641",
    "loan_card_now_type_loan_count": "11",
    "data_result_detail_behavior_report_detail_B22170019": "-99.0",
    "loan_second_by06_now_planRepayAmount_sum": "5003",
    "mobileCount": "0",
    "loan_second_repayTerms_max": "25",
    "credit_tips_total_count": "12",
    "loan_second_ncycle_month60_to_report_max_sum": "81",
    "data_result_detail_behavior_report_detail_B22170025": "-99.0",
    "loan_second_by06_now_balance_ratio_sum": "4.1396551244",
    "data_result_detail_behavior_report_detail_B22170027": "-99.0",
    "data_result_detail_behavior_report_detail_B22170022": "-99.0",
    "loan_second_m24_ncycle_month60_to_report_max_sum": "81",
    "data_result_detail_behavior_report_detail_B22170023": "-99.0",
    "NR_D180_maxLoanAmount": "0.0",
    "loan_second_by03_ncycle_as_normal_count": "7",
    "loan_second_by03_ncycle_c5_normal_count": "7",
    "loan_second_m24_month60_to_report_max_sum": "104",
    "ApplyLoanStr_m12_id_nbank_max_inteday": "-99.0",
    "loan_card_now_amount_count": "11",
    "loan_second_month60_State_countNull_mean": "1.25",
    "lc_month60_m24_N_count": "75",
    "NR_D360_loanAmount": "0.0",
    "loan_second_by12_ncycle_month60_State_num_size_range": "0.9285714286",
    "loan_second_by03_balance_ratio_sum": "4.1396551244",
    "DATA_D005": "0",
    "loan_second_ncycle_classify5_num_sum": "35.0",
    "loan_second_by12_now_is_now_sum": "11",
    "DATA_D130": "0",
    "loan_second_by12_ncycle_as_normal_count": "7",
    "loan_card_other_consumer_count": "9",
    "loan_second_by06_ncycle_classify5_num_sum": "35.0",
    "loan_second_by03_now_balance_ratio_sum": "4.1396551244",
    "loan_second_ncycle_month60_State_countNull_sum": "13",
    "loan_second_by12_month60_State_num_size_range": "0.9285714286",
    "CR_creditLimitSum": "0.0",
    "DATA_D080": "0",
    "data_result_detail_apply_report_detail_A22160006": "28",
    "data_result_detail_apply_report_detail_A22160003": "17",
    "loan_card_r_ncycle_count": "8",
    "data_result_detail_behavior_report_detail_B22170006": "-99.0",
    "NE_remainingAmount": "0.0",
    "ApplyLoanStr_m12_cell_nbank_allnum": "-99.0",
    "loan_second_month60_to_report_max_sum": "104",
    "loan_second_by12_now_classify5_num_sum": "55.0",
    "data_result_detail_behavior_report_detail_B22170001": "-99.0"
}}
from pandas.testing import assert_frame_equal
import pandas as pd

# aa = pd.DataFrame([test['data']['result']])
# print(set(aa.columns.tolist())-set(bb.columns.tolist()))

cc = pd.DataFrame([test1['features']])
# print(set(aa.columns.tolist())-set(test3))
print(len(set(test3)))
# print(set(test3)- set(cc.columns.tolist()))
# print(len(cc.columns.tolist()))
#
# print(set(cc.columns.tolist())- set(test3))
#
print(set(cc.columns.tolist())-set(test3))
#
from collections import Counter
b = dict(Counter(test3))
print(b)
print ([key for key,value in b.items() if value > 1])
